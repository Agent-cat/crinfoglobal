{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///home/vishnu/Documents/projects/crinfoglobal/frontend/utils/sanitize.js"],"sourcesContent":["import DOMPurify from 'isomorphic-dompurify';\n\n/**\n * Sanitize HTML content to prevent XSS attacks\n * @param {string} html - HTML string to sanitize\n * @returns {string} - Sanitized HTML string\n */\nexport function sanitizeHtml(html) {\n  if (!html || typeof html !== 'string') return '';\n  return DOMPurify.sanitize(html, {\n    ALLOWED_TAGS: [], // No HTML tags allowed - strip all\n    ALLOWED_ATTR: [],\n    KEEP_CONTENT: true, // Keep text content but remove tags\n  });\n}\n\n/**\n * Sanitize plain text (escape HTML entities)\n * @param {string} text - Text to sanitize\n * @returns {string} - Sanitized text safe for rendering\n */\nexport function sanitizeText(text) {\n  if (!text || typeof text !== 'string') return '';\n  \n  // Use DOMPurify to escape HTML entities\n  const div = typeof document !== 'undefined' ? document.createElement('div') : { textContent: '' };\n  if (typeof document !== 'undefined') {\n    div.textContent = text;\n    return div.innerHTML;\n  }\n  \n  // Server-side fallback: manually escape HTML entities\n  return text\n    .replace(/&/g, '&amp;')\n    .replace(/</g, '&lt;')\n    .replace(/>/g, '&gt;')\n    .replace(/\"/g, '&quot;')\n    .replace(/'/g, '&#x27;')\n    .replace(/\\//g, '&#x2F;');\n}\n\n/**\n * Sanitize email address to prevent XSS in mailto links\n * @param {string} email - Email address to sanitize\n * @returns {string} - Sanitized email or empty string if invalid\n */\nexport function sanitizeEmail(email) {\n  if (!email || typeof email !== 'string') return '';\n  \n  // Basic email validation regex\n  const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n  const sanitized = sanitizeText(email);\n  \n  // Only return if it matches email format and doesn't contain dangerous characters\n  if (emailRegex.test(sanitized) && !/[<>\"']/.test(email)) {\n    return sanitized;\n  }\n  \n  return '';\n}\n\n/**\n * Sanitize URL to prevent XSS and javascript: protocol attacks\n * @param {string} url - URL to sanitize\n * @returns {string} - Sanitized URL or empty string if invalid\n */\nexport function sanitizeUrl(url) {\n  if (!url || typeof url !== 'string') return '';\n  \n  // Remove dangerous protocols\n  const dangerousProtocols = ['javascript:', 'data:', 'vbscript:', 'file:'];\n  const lowerUrl = url.toLowerCase().trim();\n  \n  for (const protocol of dangerousProtocols) {\n    if (lowerUrl.startsWith(protocol)) {\n      return '';\n    }\n  }\n  \n  // Only allow http, https, mailto, and relative URLs\n  if (!/^(https?:\\/\\/|mailto:|#|\\/)/.test(lowerUrl) && !lowerUrl.startsWith('/')) {\n    // Allow relative paths\n    if (!lowerUrl.startsWith('.')) {\n      return '';\n    }\n  }\n  \n  return sanitizeText(url);\n}\n\n/**\n * Sanitize DOI (Digital Object Identifier)\n * @param {string} doi - DOI to sanitize\n * @returns {string} - Sanitized DOI\n */\nexport function sanitizeDoi(doi) {\n  if (!doi || typeof doi !== 'string') return '';\n  \n  // DOI format: 10.xxxx/xxxxx (alphanumeric, dots, slashes, hyphens, underscores)\n  const doiRegex = /^10\\.\\d{4,}\\/[\\w\\.\\-]+$/;\n  const sanitized = sanitizeText(doi);\n  \n  if (doiRegex.test(sanitized)) {\n    return sanitized;\n  }\n  \n  // If it doesn't match strict format, still sanitize but return\n  return sanitized.replace(/[<>\"']/g, '');\n}\n\n/**\n * Sanitize keywords (comma-separated list)\n * @param {string} keywords - Keywords string to sanitize\n * @returns {string[]} - Array of sanitized keywords\n */\nexport function sanitizeKeywords(keywords) {\n  if (!keywords || typeof keywords !== 'string') return [];\n  \n  return keywords\n    .split(',')\n    .map(kw => sanitizeText(kw.trim()))\n    .filter(kw => kw.length > 0);\n}\n\n/**\n * Sanitize author object\n * @param {object} author - Author object with name, email, affiliation, etc.\n * @returns {object} - Sanitized author object\n */\nexport function sanitizeAuthor(author) {\n  if (!author || typeof author !== 'object') return null;\n  \n  return {\n    name: sanitizeText(author.name || ''),\n    email: sanitizeEmail(author.email || ''),\n    affiliation: sanitizeText(author.affiliation || ''),\n    superscript: sanitizeText(author.superscript || ''),\n  };\n}\n\n/**\n * Sanitize article data\n * @param {object} article - Article object\n * @returns {object} - Sanitized article object\n */\nexport function sanitizeArticle(article) {\n  if (!article || typeof article !== 'object') return null;\n  \n  const sanitized = {\n    ...article,\n    title: sanitizeText(article.title || ''),\n    abstract: sanitizeText(article.abstract || ''),\n    keywords: article.keywords ? sanitizeText(article.keywords) : '',\n    doi: article.doi ? sanitizeDoi(article.doi) : '',\n    conflictOfInterest: sanitizeText(article.conflictOfInterest || ''),\n    fundingInfo: sanitizeText(article.fundingInfo || ''),\n    dataAvailability: sanitizeText(article.dataAvailability || ''),\n  };\n  \n  // Sanitize authors if present\n  if (article.authorsJson) {\n    try {\n      const authors = typeof article.authorsJson === 'string' \n        ? JSON.parse(article.authorsJson) \n        : article.authorsJson;\n      \n      if (Array.isArray(authors)) {\n        sanitized.authorsJson = authors.map(sanitizeAuthor).filter(a => a !== null);\n      }\n    } catch (e) {\n      sanitized.authorsJson = [];\n    }\n  }\n  \n  return sanitized;\n}\n\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 139, "column": 0}, "map": {"version":3,"sources":["file:///home/vishnu/Documents/projects/crinfoglobal/frontend/hooks/useAuth.js"],"sourcesContent":["import { useQuery } from '@tanstack/react-query';\nimport { checkAuth } from '../utils/api';\n\nexport const useAuth = () => {\n  return useQuery({\n    queryKey: ['auth', 'user'],\n    queryFn: async () => {\n      if (process.env.NODE_ENV === 'development') {\n        console.log('ðŸ”„ Checking authentication...');\n      }\n      const data = await checkAuth();\n      if (process.env.NODE_ENV === 'development') {\n        console.log('âœ… Auth check complete:', data?.email || 'No user');\n      }\n      return data;\n    },\n    retry: false,\n    staleTime: 5 * 60 * 1000, // 5 minutes\n  });\n};\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,MAAM,UAAU;IACrB,OAAO,IAAA,uLAAQ,EAAC;QACd,UAAU;YAAC;YAAQ;SAAO;QAC1B,SAAS;YACP,wCAA4C;gBAC1C,QAAQ,GAAG,CAAC;YACd;YACA,MAAM,OAAO,MAAM,IAAA,yHAAS;YAC5B,wCAA4C;gBAC1C,QAAQ,GAAG,CAAC,0BAA0B,MAAM,SAAS;YACvD;YACA,OAAO;QACT;QACA,OAAO;QACP,WAAW,IAAI,KAAK;IACtB;AACF","debugId":null}},
    {"offset": {"line": 171, "column": 0}, "map": {"version":3,"sources":["file:///home/vishnu/Documents/projects/crinfoglobal/frontend/app/article/%5B...slug%5D/ArticleContent.js"],"sourcesContent":["\n\"use client\";\nimport React, { useState, useEffect } from 'react'\nimport { requestDownload, downloadArticlePdf } from '../../../utils/api'\nimport { sanitizeText, sanitizeEmail, sanitizeDoi, sanitizeKeywords, sanitizeAuthor } from '../../../utils/sanitize'\nimport Link from 'next/link'\nimport { useAuth } from '../../../hooks/useAuth'\n\nexport default function ArticleContent({ article, initialTab }) {\n    const [showModal, setShowModal] = useState(false)\n    const [tab, setTab] = useState(initialTab || 'abstract')\n    const [citationStyles, setCitationStyles] = useState({ apa: '', vancouver: '', bibtex: '' })\n    const [activeStyle, setActiveStyle] = useState('apa')\n    const [loadingCitation, setLoadingCitation] = useState(false)\n    const [showCitation, setShowCitation] = useState(false)\n\n    const authorsRaw = typeof article.authorsJson === 'string'\n        ? JSON.parse(article.authorsJson)\n        : article.authorsJson;\n    \n    // Sanitize all authors\n    const authors = Array.isArray(authorsRaw) \n        ? authorsRaw.map(sanitizeAuthor).filter(a => a !== null)\n        : [];\n\n    const handleDownload = async () => {\n        try {\n            const res = await downloadArticlePdf(article.id);\n            const blobUrl = window.URL.createObjectURL(res.data);\n            const a = document.createElement('a');\n            a.href = blobUrl;\n            const safeTitle = sanitizeText(article.title || 'article').substring(0, 30).replace(/[<>:\"/\\\\|?*]/g, '');\n            a.download = `${safeTitle}.pdf`;\n            a.click();\n            window.URL.revokeObjectURL(blobUrl);\n        } catch (err) {\n            // Check auth state to see if they have global access (this should have succeeded if so)\n            // But if it failed (403), show modal\n            setShowModal(true);\n        }\n    };\n\n    useEffect(() => {\n        if (tab === 'cite' && !citationStyles.apa) {\n            generateCitations();\n        }\n    }, [tab, citationStyles.apa]);\n\n    const generateCitations = async () => {\n        setLoadingCitation(true);\n        try {\n            // Dynamically import citation-js only when needed\n            const { default: Cite } = await import('citation-js');\n\n            const authorsList = authors || [];\n            const cslAuthors = authorsList.map(a => ({\n                literal: a.name.trim()\n            }));\n\n            const date = article.publishedAt ? new Date(article.publishedAt) : new Date();\n\n            const data = [{\n                id: article.id,\n                type: 'article-journal',\n                title: sanitizeText(article.title || ''),\n                author: cslAuthors,\n                issued: {\n                    'date-parts': [[date.getFullYear(), date.getMonth() + 1, date.getDate()]]\n                },\n                'container-title': 'Frontiers in Engineering and Informatics',\n                volume: article.volume?.number,\n                issue: article.issue?.number,\n                page: article.startPage && article.endPage ? `${article.startPage}-${article.endPage}` : undefined,\n                DOI: article.doi ? sanitizeDoi(article.doi) : undefined,\n                ISSN: '3049-3412',\n                publisher: 'Crinfo Global Publishers'\n            }];\n\n            const cite = new Cite(data);\n\n            setCitationStyles({\n                apa: cite.format('bibliography', { template: 'apa', lang: 'en-US' }),\n                vancouver: cite.format('bibliography', { template: 'vancouver', lang: 'en-US' }),\n                bibtex: cite.format('bibtex')\n            });\n        } catch (err) {\n            console.error('Citation generation error:', err);\n        } finally {\n            setLoadingCitation(false);\n        }\n    };\n\n    const copyToClipboard = (text, e) => {\n        const btn = e.currentTarget;\n        const originalText = btn.textContent;\n        navigator.clipboard.writeText(text).then(() => {\n            btn.textContent = 'Copied!';\n            btn.classList.add('bg-green-600');\n            setTimeout(() => {\n                btn.textContent = originalText;\n                btn.classList.remove('bg-green-600');\n            }, 2000);\n        });\n    };\n\n    const { data: user } = useAuth();\n\n    return (\n        <>\n            <div className='mt-6 animate-in fade-in duration-300'>\n                {/* Author Details Section */}\n                {authors && Array.isArray(authors) && authors.length > 0 && (\n                    <div className='mb-8 border-b pb-6'>\n                        <div className='flex flex-col gap-4'>\n                            {authors.map((author, i) => {\n                                const safeEmail = sanitizeEmail(author.email);\n                                return (\n                                    <div key={i} className='flex flex-col'>\n                                        <span className='font-bold text-lg text-[#083b7a]'>{author.name}</span>\n                                        {author.affiliation && (\n                                            <span className='text-gray-600 text-sm italic'>{author.affiliation}</span>\n                                        )}\n                                        {safeEmail && (\n                                            <div className='flex items-center gap-1 mt-1'>\n                                                <svg className='w-3 h-3 text-gray-500' fill='none' stroke='currentColor' viewBox='0 0 24 24'>\n                                                    <path strokeLinecap='round' strokeLinejoin='round' strokeWidth={2} d='M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z' />\n                                                </svg>\n                                                <a href={`mailto:${safeEmail}`} className='text-blue-600 text-sm hover:underline'>\n                                                    {safeEmail}\n                                                </a>\n                                            </div>\n                                        )}\n                                    </div>\n                                );\n                            })}\n                        </div>\n                    </div>\n                )}\n                <h2 className='text-lg font-semibold mb-4'>Abstract</h2>\n                <p className='text-gray-800 leading-relaxed whitespace-pre-wrap text-lg'>{sanitizeText(article.abstract || '')}</p>\n\n                {article.keywords && (\n                    <div className='mt-8 pt-6 border-t'>\n                        <div className='text-sm font-bold text-gray-900 mb-2 uppercase tracking-wide'>Keywords</div>\n                        <div className='flex flex-wrap gap-2'>\n                            {sanitizeKeywords(article.keywords).map((kw, i) => (\n                                <span key={i} className='px-3 py-1 bg-blue-50 text-blue-700 text-sm rounded-full border border-blue-100'>\n                                    {kw}\n                                </span>\n                            ))}\n                        </div>\n                    </div>\n                )}\n\n                <div className='mt-8 pt-6 border-t flex flex-col gap-6 md:flex-row md:items-center md:justify-between bg-gray-50 p-6 rounded-xl border border-gray-100'>\n                    <div className='flex-1'>\n                        {article.doi && (() => {\n                            const safeDoi = sanitizeDoi(article.doi);\n                            return safeDoi ? (\n                                <Link href={`https://www.doi.org/${safeDoi}`} className='inline-flex flex-col bg-orange-50 border border-orange-200 rounded-lg px-4 py-2 hover:bg-orange-100 transition-colors'>\n                                    <span className='text-xs font-bold text-orange-800 uppercase tracking-wider mb-0.5'>DOI</span>\n                                    <span className='text-sm font-mono text-orange-900 break-all select-all font-medium'>www.doi.org/{safeDoi}</span>\n                                </Link>\n                            ) : null;\n                        })()}\n                    </div>\n                    <div className='flex flex-wrap gap-3'>\n                        <button\n                            className={`px-5 py-2.5 rounded-lg border transition-all font-medium flex items-center gap-2 ${showCitation ? 'bg-gray-200 border-gray-300 text-gray-800' : 'bg-white border-gray-300 text-gray-700 hover:bg-gray-50'}`}\n                            onClick={() => {\n                                setShowCitation(!showCitation);\n                                if (!citationStyles.apa && !showCitation) generateCitations();\n                            }}\n                        >\n                            <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z\" /></svg>\n                            Cite\n                        </button>\n                        {article.pdfPath && (() => {\n                            const safeDoi = article.doi ? sanitizeDoi(article.doi) : null;\n                            return (\n                                <a\n                                    href={safeDoi ? `/article_repo/${safeDoi}.pdf` : '#'}\n                                    target={safeDoi ? \"_blank\" : undefined}\n                                    rel={safeDoi ? \"noopener noreferrer\" : undefined}\n                                    className='px-5 py-2.5 rounded-lg bg-red-600 text-white hover:bg-red-700 transition-colors font-medium flex items-center gap-2 shadow-sm'\n                                    onClick={!safeDoi ? handleDownload : undefined}\n                                >\n                                    <svg className=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm1-11a1 1 0 10-2 0v3.586L7.707 9.293a1 1 0 00-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 10.586V7z\" /></svg>\n                                    {safeDoi ? 'View PDF' : 'Download PDF'}\n                                </a>\n                            );\n                        })()}\n                    </div>\n                </div>\n\n                {showCitation && (\n                    <div className='mt-6 animate-in slide-in-from-top-4 duration-300'>\n                        <div className='flex items-center justify-between mb-4'>\n                            <h2 className='text-lg font-semibold'>Cite this article</h2>\n                            <div className='flex bg-gray-100 p-1 rounded-lg text-xs font-medium'>\n                                {['apa', 'vancouver', 'bibtex'].map((style) => (\n                                    <button\n                                        key={style}\n                                        onClick={() => setActiveStyle(style)}\n                                        className={`px-3 py-1 rounded-md transition-all ${activeStyle === style ? 'bg-white shadow-sm text-[#083b7a]' : 'text-gray-500 hover:text-gray-700'}`}\n                                    >\n                                        {style.toUpperCase()}\n                                    </button>\n                                ))}\n                            </div>\n                        </div>\n\n                        <div className='border rounded-xl p-6 bg-gray-50/50 space-y-4'>\n                            {loadingCitation ? (\n                                <div className='flex items-center justify-center py-10'>\n                                    <div className='animate-spin rounded-full h-8 w-8 border-b-2 border-[#083b7a]'></div>\n                                </div>\n                            ) : (\n                                <>\n                                    <div className='text-sm text-gray-800 leading-relaxed citation-content font-serif'>\n                                        {citationStyles[activeStyle] || 'Generating citation...'}\n                                    </div>\n\n                                    <button\n                                        className='w-full md:w-auto px-6 py-2.5 rounded-lg bg-[#083b7a] text-white hover:bg-[#0a4ea3] transition-all text-sm font-semibold active:scale-95 flex items-center justify-center gap-2'\n                                        onClick={(e) => copyToClipboard(citationStyles[activeStyle], e)}\n                                    >\n                                        <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3\" />\n                                        </svg>\n                                        Copy {activeStyle.toUpperCase()} Citation\n                                    </button>\n                                </>\n                            )}\n                        </div>\n                    </div>\n                )}\n            </div>\n\n            {showModal && (\n                <div className='fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200'>\n                    <div className='bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full animate-in zoom-in-95 duration-200'>\n                        <div className='w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mb-4'>\n                            <svg className='w-6 h-6 text-blue-600' fill='none' stroke='currentColor' viewBox='0 0 24 24'>\n                                <path strokeLinecap='round' strokeLinejoin='round' strokeWidth={2} d='M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z' />\n                            </svg>\n                        </div>\n                        <h3 className='text-xl font-bold text-gray-900 mb-2'>Request Full Access</h3>\n                        <p className='text-gray-600 mb-6'>\n                            {user?.hasFullAccess ?\n                                \"You have full access to all articles. Click download to get the PDF.\" :\n                                user?.hasPendingRequest ?\n                                    \"You have a pending request for full access. You will be notified via email once an admin approves it.\" :\n                                    \"Access restricted. Request full access once to download this and all other PDFs.\"\n                            }\n                        </p>\n                        <div className='flex flex-col sm:flex-row justify-end gap-3'>\n                            <button\n                                className='px-4 py-2 rounded-xl border border-gray-200 text-gray-600 hover:bg-gray-50 transition-colors font-medium'\n                                onClick={() => setShowModal(false)}\n                            >\n                                Cancel\n                            </button>\n                            {!user?.hasFullAccess && !user?.hasPendingRequest && (\n                                <button\n                                    className='px-6 py-2 rounded-xl bg-[#083b7a] text-white hover:bg-[#0a4ea3] transition-all font-semibold shadow-lg shadow-blue-200'\n                                    onClick={async () => {\n                                        try { await requestDownload(article.id); } catch { }\n                                        setShowModal(false);\n                                    }}\n                                >\n                                    Request Full Access\n                                </button>\n                            )}\n                        </div>\n                    </div>\n                </div>\n            )}\n        </>\n    )\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}