module.exports=[15582,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(38246),e=a.i(10850),f=a.i(73233),g=a.i(48024),h=a.i(66960),i=a.i(73445),j=a.i(88770);a.s(["default",0,()=>{let{data:a,isLoading:k,error:l}=(0,e.useAuth)(),{data:m=[],isLoading:n}=(0,f.useVolumes)(),{data:o=[],isLoading:p}=(0,h.useSubmittedArticles)(),{data:q=[],isLoading:r}=(0,h.usePublishedArticles)(),{data:s=[],isLoading:t}=(0,i.useDownloadRequests)(),u=(0,h.useCreateAndPublishArticle)(),[v,w]=(0,c.useState)(null),[x,y]=(0,c.useState)({}),[z,A]=(0,c.useState)({title:"",abstract:"",keywords:"",pages:"",doi:"",issueId:"",file:null,scriptFile:null,authors:[{name:"",email:"",affiliation:"",superscript:""}]}),[B,C]=(0,c.useState)(!1),[D,E]=(0,c.useState)(""),F=(0,h.usePublishArticle)(),G=async(a,b)=>{if(!b)return void alert("Please select an issue first");try{await F.mutateAsync({articleId:a,issueId:b}),alert("Article published successfully!")}catch(a){console.error("Failed to publish article:",a),alert("Failed to publish article. Please try again.")}},H=(a,b,c)=>{A(d=>({...d,authors:d.authors.map((d,e)=>e===a?{...d,[b]:c}:d)}))},I=async a=>{if(a.preventDefault(),!z.title||!z.abstract||!z.issueId)return void E("Please fill in all required fields (Title, Abstract, and Issue)");if(!z.authors.some(a=>a.name&&a.email))return void E("Please add at least one author with name and email");E("");try{let a=new FormData;a.append("title",z.title),a.append("abstract",z.abstract),a.append("keywords",z.keywords),a.append("pages",z.pages),a.append("doi",z.doi),a.append("issueId",z.issueId),a.append("authors",JSON.stringify(z.authors)),z.file&&a.append("file",z.file),z.scriptFile&&a.append("script",z.scriptFile),await u.mutateAsync(a),E("Article published successfully!"),A({title:"",abstract:"",keywords:"",pages:"",doi:"",issueId:"",file:null,scriptFile:null,authors:[{name:"",email:"",affiliation:"",superscript:""}]})}catch(a){console.error("Failed to publish article:",a),E(a.response?.data?.message||"Failed to publish article. Please try again.")}};return k?(0,b.jsx)("div",{className:"min-h-screen bg-white mt-16 py-8 px-5",children:(0,b.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,b.jsx)("div",{className:"h-6 w-40 bg-gray-200 animate-pulse rounded mb-6"})})}):l||!a?(0,b.jsx)("div",{className:"min-h-screen bg-white mt-16 py-8 px-5",children:(0,b.jsx)("div",{className:"max-w-2xl mx-auto text-center",children:"Please sign in."})}):"EDITOR"!==a.role?(0,b.jsx)("div",{className:"min-h-screen bg-white mt-16 py-8 px-5",children:(0,b.jsx)("div",{className:"max-w-2xl mx-auto text-center",children:"Forbidden. Editor access required."})}):(0,b.jsx)("div",{className:"min-h-screen w-full text-black bg-white mt-16 py-8 px-5",children:(0,b.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,b.jsx)("h1",{className:"text-2xl md:text-3xl font-bold",children:"Publish Articles"}),(0,b.jsx)("div",{className:"flex gap-3",children:(0,b.jsx)(d.default,{href:"/admin",className:"px-4 py-2 rounded-lg border border-gray-300 text-sm hover:bg-gray-50 transition-colors",children:"â† Back to Admin"})})]}),(0,b.jsxs)("section",{className:"bg-gray-50 rounded-lg p-4 md:p-6",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold mb-4 text-gray-800",children:"Publish New Article"}),D&&(0,b.jsx)("div",{className:`mb-4 p-3 rounded-lg ${D.includes("successfully")?"bg-green-50 text-green-800 border border-green-200":"bg-red-50 text-red-800 border border-red-200"}`,children:D}),(0,b.jsxs)("form",{onSubmit:I,className:"bg-white rounded-lg p-6 shadow-sm",children:[(0,b.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Upload Article ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)("input",{type:"file",accept:".pdf",className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#083b7a]",onChange:a=>A(b=>({...b,file:a.target.files[0]}))}),(0,b.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:z.file?z.file.name:"No file chosen"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Upload Script File (Optional)"}),(0,b.jsx)("input",{type:"file",className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#083b7a]",onChange:a=>A(b=>({...b,scriptFile:a.target.files[0]}))}),(0,b.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:z.scriptFile?z.scriptFile.name:"Upload any scripts or code files related to the research"})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Title ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)("input",{type:"text",className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#083b7a]",value:z.title,onChange:a=>A(b=>({...b,title:a.target.value})),placeholder:"Article title",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Abstract ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)("textarea",{className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#083b7a] h-24",value:z.abstract,onChange:a=>A(b=>({...b,abstract:a.target.value})),placeholder:"Article abstract",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Keywords"}),(0,b.jsx)("input",{type:"text",className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#083b7a]",value:z.keywords,onChange:a=>A(b=>({...b,keywords:a.target.value})),placeholder:"Keywords (comma separated)"})]})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Pages"}),(0,b.jsx)("input",{type:"text",className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#083b7a]",value:z.pages,onChange:a=>A(b=>({...b,pages:a.target.value})),placeholder:"e.g., 1-15"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"DOI"}),(0,b.jsx)("input",{type:"text",className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#083b7a]",value:z.doi,onChange:a=>A(b=>({...b,doi:a.target.value})),placeholder:"DOI"})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Select Issue ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsxs)("select",{className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#083b7a]",value:z.issueId,onChange:a=>A(b=>({...b,issueId:a.target.value})),required:!0,children:[(0,b.jsx)("option",{value:"",children:"Select Issue"}),m.flatMap(a=>(a.issues||[]).map(b=>({...b,volumeNumber:a.number}))).map(a=>(0,b.jsxs)("option",{value:a.id,children:["Vol ",a.volumeNumber," - Issue ",a.number," (",a.month," ",a.year,")"]},a.id))]})]})]})]}),(0,b.jsxs)("div",{className:"mt-6",children:[(0,b.jsx)("h3",{className:"text-lg font-medium text-gray-800 mb-4",children:"Authors"}),(0,b.jsxs)("div",{className:"space-y-4",children:[z.authors.map((a,c)=>(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 p-4 border rounded-lg bg-gray-50",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Name ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)("input",{type:"text",className:"w-full border rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#083b7a]",value:a.name,onChange:a=>H(c,"name",a.target.value),placeholder:"Author name",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Email ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)("input",{type:"email",className:"w-full border rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#083b7a]",value:a.email,onChange:a=>H(c,"email",a.target.value),placeholder:"Author email",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Affiliation"}),(0,b.jsx)("input",{type:"text",className:"w-full border rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#083b7a]",value:a.affiliation,onChange:a=>H(c,"affiliation",a.target.value),placeholder:"Institution"})]}),(0,b.jsxs)("div",{className:"flex items-end gap-2",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Superscript"}),(0,b.jsx)("input",{type:"text",className:"w-full border rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#083b7a]",value:a.superscript,onChange:a=>H(c,"superscript",a.target.value),placeholder:"1, 2, etc."})]}),z.authors.length>1&&(0,b.jsx)("button",{type:"button",className:"px-3 py-2 bg-red-500 text-white rounded hover:bg-red-600 transition-colors",onClick:()=>{A(a=>({...a,authors:a.authors.filter((a,b)=>b!==c)}))},children:"Remove"})]})]},c)),(0,b.jsx)("button",{type:"button",className:"flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",onClick:()=>{A(a=>({...a,authors:[...a.authors,{name:"",email:"",affiliation:"",superscript:""}]}))},children:"âž• Add Author"})]})]}),(0,b.jsx)("div",{className:"mt-6 flex justify-end",children:(0,b.jsx)("button",{type:"submit",disabled:u.isPending,className:"flex items-center gap-2 px-6 py-2 bg-[#083b7a] text-white rounded-lg hover:bg-[#0a4ea3] transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:u.isPending?"Publishing...":"ðŸ“¨ Upload Article"})})]})]}),(0,b.jsxs)("section",{className:"bg-gray-50 rounded-lg p-6 mt-8",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold mb-4 text-gray-800",children:"Submitted Articles"}),(0,b.jsxs)("div",{className:"space-y-4",children:[o.map(a=>(0,b.jsxs)("div",{className:"bg-white border rounded-lg p-4 shadow-sm",children:[(0,b.jsx)("div",{className:"font-semibold text-gray-800 mb-1",children:(0,j.sanitizeText)(a.title||"")}),(0,b.jsx)("div",{className:"text-sm text-gray-600 mb-3",children:a.articleType}),(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2 mb-3",children:[(0,b.jsx)("button",{className:"px-3 py-1 rounded border border-gray-300 hover:bg-gray-50 text-sm transition-colors",onClick:()=>w(v===a.id?null:a.id),children:v===a.id?"Hide Details":"View Details"}),(0,b.jsxs)("select",{className:"flex-1 border rounded px-2 py-1 text-sm",defaultValue:"",children:[(0,b.jsx)("option",{value:"",disabled:!0,children:"Select Issue"}),m.flatMap(a=>(a.issues||[]).map(b=>({...b,volumeNumber:a.number}))).map(a=>(0,b.jsxs)("option",{value:a.id,children:["Vol ",a.volumeNumber," - Issue ",a.number," (",a.month," ",a.year,")"]},a.id))]}),(0,b.jsx)("button",{className:"px-3 py-1 rounded bg-[#083b7a] text-white hover:bg-[#0a4ea3] text-sm transition-colors",onClick:b=>{let c=b.currentTarget.previousSibling;c&&c instanceof HTMLSelectElement&&c.value&&G(a.id,c.value)},children:"Publish"})]}),v===a.id&&(0,b.jsxs)("div",{className:"text-sm text-gray-700 border-t pt-3 mt-3 space-y-2",children:[a.keywords&&(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"font-medium",children:"Keywords:"})," ",(0,j.sanitizeText)(a.keywords)]}),a.abstract&&(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-medium mb-1",children:"Abstract"}),(0,b.jsx)("div",{className:"whitespace-pre-wrap text-gray-600",children:(0,j.sanitizeText)(a.abstract)})]}),a.pdfPath&&(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("a",{className:"text-blue-700 hover:underline",href:a.pdfPath.startsWith("/api/")?`${g.BASE_URL}${a.pdfPath}`:a.pdfPath,target:"_blank",rel:"noreferrer",children:"Download PDF"}),"number"==typeof a.totalPages&&(0,b.jsxs)("span",{className:"text-gray-500",children:["(",a.totalPages," pages)"]})]})]})]},a.id)),0===o.length&&(0,b.jsx)("div",{className:"text-center text-gray-500 py-8 bg-white rounded-lg border",children:"No submissions pending"})]})]}),(0,b.jsxs)("section",{className:"bg-gray-50 rounded-lg p-6 mt-8",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold mb-4 text-gray-800",children:"Published Articles"}),(0,b.jsxs)("div",{className:"space-y-4",children:[q.map(a=>(0,b.jsxs)("div",{className:"bg-white border rounded-lg p-4 shadow-sm",children:[(0,b.jsx)("div",{className:"font-semibold text-gray-800 mb-1",children:(0,j.sanitizeText)(a.title||"")}),(0,b.jsx)("div",{className:"text-sm text-gray-600 mb-2",children:a.articleType}),a.issue&&(0,b.jsxs)("div",{className:"text-sm text-gray-500 mb-2",children:["Volume ",a.issue.volume?.number," â€¢ Issue ",a.issue.number," (",a.issue.month," ",a.issue.year,")"]}),(0,b.jsx)("div",{className:"flex flex-col sm:flex-row gap-2 mb-3",children:(0,b.jsx)("button",{className:"px-3 py-1 rounded border border-gray-300 hover:bg-gray-50 text-sm transition-colors",onClick:()=>w(v===a.id?null:a.id),children:v===a.id?"Hide Details":"View Details"})}),v===a.id&&(0,b.jsxs)("div",{className:"text-sm text-gray-700 border-t pt-3 mt-3 space-y-2",children:[a.doi&&(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"font-medium",children:"DOI:"})," ",(0,j.sanitizeText)(a.doi)]}),a.keywords&&(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"font-medium",children:"Keywords:"})," ",(0,j.sanitizeText)(a.keywords)]}),a.abstract&&(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-medium mb-1",children:"Abstract"}),(0,b.jsx)("div",{className:"whitespace-pre-wrap text-gray-600",children:(0,j.sanitizeText)(a.abstract)})]}),a.pdfPath&&(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("a",{className:"text-blue-700 hover:underline",href:a.pdfPath.startsWith("/api/")?`${g.BASE_URL}${a.pdfPath}`:a.pdfPath,target:"_blank",rel:"noreferrer",children:"Download PDF"}),"number"==typeof a.totalPages&&(0,b.jsxs)("span",{className:"text-gray-500",children:["(",a.totalPages," pages)"]})]})]})]},a.id)),0===q.length&&(0,b.jsx)("div",{className:"text-center text-gray-500 py-8 bg-white rounded-lg border",children:"No published articles"})]})]}),(0,b.jsxs)("section",{className:"bg-gray-50 rounded-lg p-6 mt-8",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold mb-4 text-gray-800",children:"Download Requests"}),(0,b.jsxs)("div",{className:"space-y-3",children:[s.map(a=>(0,b.jsxs)("div",{className:"bg-white border rounded-lg p-4 shadow-sm flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:[(0,b.jsxs)("div",{className:"text-sm text-gray-700",children:[(0,b.jsx)("div",{className:"font-semibold text-gray-900",children:a.article?.title||"â€”"}),(0,b.jsxs)("div",{className:"text-gray-600",children:["Volume ",a.article?.issue?.volume?.number??"â€”","number"==typeof a.article?.issue?.number&&(0,b.jsxs)("span",{children:[" â€¢ Issue ",a.article.issue.number]})]}),(0,b.jsxs)("div",{className:"text-gray-600",children:["Request by: ",a.user?.email||a.userId]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"font-medium",children:"Status:"})," ",a.status]})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:["APPROVED"!==a.status&&(0,b.jsx)("button",{className:"px-3 py-1 rounded bg-green-600 text-white hover:bg-green-700 text-sm",onClick:async()=>{await approveDownloadRequest(a.id),setDownloadRequests(b=>b.map(b=>b.id===a.id?{...b,status:"APPROVED"}:b))},children:"Approve"}),"PENDING"===a.status&&(0,b.jsx)("button",{className:"px-3 py-1 rounded bg-red-600 text-white hover:bg-red-700 text-sm",onClick:async()=>{await denyDownloadRequest(a.id),setDownloadRequests(b=>b.map(b=>b.id===a.id?{...b,status:"DENIED"}:b))},children:"Deny"})]})]},a.id)),0===s.length&&(0,b.jsx)("div",{className:"text-center text-gray-500 py-8 bg-white rounded-lg border",children:"No download requests"})]})]})]})})}])}];

//# sourceMappingURL=app_admin_publish_page_3dcea519.js.map